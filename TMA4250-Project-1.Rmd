---
title: "TMA4250-Project-1"
author: "Ole Riddervold, Ole Kristian Skogly"
date: "2023-02-07"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# install.packages("geoR")
# install.packages("akima")
# install.packages("fields")
# install.packages("ggplot2")
# install.packages("MASS")

library(geoR)
library(akima)
library(fields)
library(ggplot2)
library(MASS)
```

# Problem 1

## a)

## b)
```{r 1b0}
powered_exponential <- function(h, a, alpha) {
  # Powered exponential correlation function as defined in lectures
  return(
    exp(-(h/a)^alpha)
  )
}

matern_modified <- function(h, a, nu) {
  # Matern correlation function as defined in lectures (based on matern from geoR)
  phi <- a/sqrt(8*nu)
  return(
    matern(h, phi, nu)
  )
}
```

Defining parameters that are constant for the different cases:
```{r 1b1}
s <- c(1:50)
N <- 4
variance <- c(1, 5)
array_dims <- c(4, 4, length(s)) # Dimensions of the data-array to be plotted

dist_matrix <- as.matrix(dist(s, diag=TRUE, upper=TRUE))
mu <- rep(0, length(s))
```

Loop for powered exponential correlation function:
```{r 1b2}
alpha <- c(1, 1.9)
exp_a <- 10
exp_realizations <- array(rep(0, prod(array_dims)), array_dims)

for (i in seq_along(variance)) {
  for (j in seq_along(alpha)) {
    Sigma <- variance[i]*powered_exponential(dist_matrix, exp_a, alpha[j])
    flattened_index <- 2*(i-1)%%2 + j
    exp_realizations[flattened_index, , ] <- as.array(mvrnorm(n=N, mu, Sigma))
  }
}
```

Loop for matern correlation functions:
```{r 1b3}
nu_values <- c(1, 3)
matern_a <- 10
matern_realizations <- array(rep(0, prod(array_dims)), array_dims)

for (i in seq_along(variance)) {
  for (j in seq_along(alpha)) {
    Sigma <- variance[i]*powered_exponential(dist_matrix, exp_a, alpha[j])
    flattened_index <- 2*(i-1)%%2 + j
    matern_realizations[flattened_index, , ] <- as.array(mvrnorm(n=N, mu, Sigma))
  }
}
```

Plot:
```{r 1b4}

```

## c)

## d)

## e)

## f)

## g)


# Problem 2

## a)

## b)

## c)

## d)

## e)

## f)


# Problem 3

## a)

## b)

## c)

## d)

## e)

## f)